# 操作系统

## 第一章

### 页面置换算法
> **缺页**：只要物理块中都没有当前页，就算缺页

#### 先进先出置换算法（FIFO）
这种算法认为：最早调入主存的页面不再被使用的可能性最大。所以当需要淘汰一个页面时，总是选择驻留主存时间最长的页面进行淘汰，即先进入主存的页面先淘汰。

|访问页面 | 1 | 2 | 3 | 4 | 2 | 1 | 5 | 2 | 1 |
|:-: | :-: | :-: | :-: | :-: | :-: | :-: | :-:| :-: | :-:|
|物理块1 | $$1^*$$ | 1 | 1 | $$4^*$$ |  | 4 | 4 | $$2^*$$ | |
|物理块2 |  | $$2^*$$ | 2 | 2 |  | $$1^*$$ | 1 | 1| |
|物理块3 |  |  | $$3^*$$ | 3 |  | 3 | $$5^*$$ | 5 |  |
|是否缺页 | $$\surd$$  | $$\surd$$ | $$\surd$$ | $$\surd$$ |  | $$\surd$$ | $$\surd$$ | $$\surd$$ |  | |

> FIFO 算法还会产生当所分配的物理块数增大，而缺页故障不减反增的情况。这是由 Belady于1969年发现，故称为Belady异常。只有FIFO算法可能出现Belady 异常，而LRU和OPT算法永远不会出现Belady异常。

一个Belady实例如下：
当有三个物理块时，缺页率：9/12

|访问页面 | 1 | 2 | 3 | 4 | 1 | 2 | 5 | 1 | 2 | 3 | 4 | 5|
|:-: | :-: | :-: | :-: | :-: | :-: | :-: | :-:| :-: | :-:|:-:| :-: | :-:|
|物理块1| $$1^*$$  | 1  | 1  |  $$4^*$$ | 4  | 4  | $$5^*$$  |   |   |  5 | 5  |   |
|物理块2|   | $$2^*$$  |2   | 2  | $$1^*$$  | 1  | 1  |   |   | $$3^*$$  |  3 |   |
|物理块3|   |   | $$3^*$$  | 3  | 3  | $$2^*$$  | 2  |   |   | 2  | $$4^*$$  |   |
|是否缺页|  $$\surd$$ | $$\surd$$  | $$\surd$$  |  $$\surd$$ |  $$\surd$$ |  $$\surd$$ | $$\surd$$| | |$$\surd$$   |$$\surd$$   |   | |

当有4个物理块时，缺页率：10/12

|访问页面 | 1 | 2 | 3 | 4 | 1 | 2 | 5 | 1 | 2 | 3 | 4 | 5|
|:-: | :-: | :-: | :-: | :-: | :-: | :-: | :-:| :-: | :-:|:-:| :-: | :-:|
|物理块1| $$1^*$$  | 1  |  1 | 1  |   |   |  $$5^*$$ | 5  |  5 | 5  |  $$4^*$$ | 4  |
|物理块2|   |$$2^*$$   |2   |2   |   |   |2   |$$1^*$$   |1   |1   |1   | $$5^*$$  |
|物理块3|   |   |$$3^*$$   |3   |   |   | 3  |3   |$$2^*$$   | 2  | 2  | 2  |
|物理块4|   |   |   | $$4^*$$  |   |   | 4  |  4 | 4  | $$3^*$$  |3   |3   |
|是否缺页 | $$\surd$$  | $$\surd$$  | $$\surd$$  |  $$\surd$$ | | | $$\surd$$  | $$\surd$$  | $$\surd$$  | $$\surd$$  | $$\surd$$  | $$\surd$$  |



>即：缺页率高表现为：刚换出去的页面又要换回内存

极端表现如下：

|访问页面 | 1 | 2 | 3 | 4 | 5 | 1 | 2 | 3 | 4 |
|:-: | :-: | :-: | :-: | :-: | :-: | :-: | :-:| :-: | :-:|
|物理块1| $$1^*$$  |  1 |  1 | 1  | $$5^*$$  | 5  | 5  | 5  | $$4^*$$  |
|物理块2|   | $$2^*$$  | 2  | 2  | 2  | $$1^*$$  | 1  | 1  | 1  |
|物理块3|   |   | $$3^*$$  |3   | 3  | 3  | $$2^*$$  | 2|2|
|物理块4 |   |   |   | $$4^*$$  | 4  | 4  | 4  | $$3^*$$   |3|


#### 最近最久未使用（LRU）算法
利用局部性原理，根据一个作业在执行过程中过去的页面访问历史来推测未来的行为。它认为过去一段时间里不曾被访问过的页面，在最近的将来可能也不会再被访问。所以，这种算法的实质是：当需要淘汰一个页面时，总是选择在最近一段时间内最久不用的页面予以淘汰。

|访问页面 | 1 | 2 | 3 | 4 | 2 | 1 | 5 | 2 | 1 |
|:-: | :-: | :-: | :-: | :-: | :-: | :-: | :-:| :-: | :-:|
|物理块1|$$1^*$$   | 1  |1   | $$4^*$$ | | 4  | $$5^*$$  | |   |
|物理块2|   | $$2^*$$  |2   |2   |   |2   |2|   |   |
|物理块3|   |   |$$3^*$$|3   |   |$$1^*$$ |1|   |   |
|是否缺页| $$\surd$$|$$\surd$$|$$\surd$$|$$\surd$$|   |   |   $$\surd$$|$$\surd$$|   | |


#### 最佳置换算法（OPT 理想置换算法）
实现原理：从主存中移出永远不再需要的页面；如无这样的页面存在，则选择最长时间不需要访问的页面。于所选择的被淘汰页面将是以后永不使用的，或者是在最长时间内不再被访问的页面，这样可以保证获得最低的缺页率。

|访问页面 | 1 | 2 | 3 | 4 | 2 | 1 | 5 | 2 | 1 |
|:-: | :-: | :-: | :-: | :-: | :-: | :-: | :-:| :-: | :-:|
|物理块1|$$1^*$$|1|1|1|   |   |1|   |   |
|物理块2|   |$$2^*$$|2   |2 |   |   |2| |   |
|物理块3|   |   |$$3^*$$|$$4^*$$|   |   |$$5^*$$|   |   |
|是否缺页| $$\surd$$  | $$\surd$$  | $$\surd$$  | $$\surd$$  || |$$\surd$$ | |  | |



https://www.cnblogs.com/fkissx/p/4712959.html
